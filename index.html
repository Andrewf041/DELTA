<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DELTA</title>

<style>
:root{
  --bg:#0b0f0d;
  --panel:#121816;
  --user:#1f2925;
  --delta:#151c19;
  --accent:#10a37f;
  --text:#e6f2ee;
}
*{box-sizing:border-box}
body{
  margin:0;
  min-height:100vh;
  background:var(--bg);
  color:var(--text);
  font-family:system-ui,Arial;
  display:flex;
  flex-direction:column;
}
header{
  display:flex;
  align-items:center;
  gap:10px;
  padding:10px 12px;
  border-bottom:1px solid #1f2a25;
}
.logo{width:30px;height:30px}
#tabs{display:flex;gap:6px;overflow-x:auto;flex:1}
.tab{
  padding:5px 8px;
  border-radius:8px;
  border:1px solid #1f2a25;
  font-size:13px;
  opacity:.6;
}
.tab.active{
  background:var(--accent);
  color:#000;
  opacity:1;
}
header button{
  background:var(--accent);
  border:none;
  border-radius:10px;
  padding:6px 10px;
}
#chat{
  flex:1;
  overflow-y:auto;
  padding:12px;
  display:flex;
  flex-direction:column;
  gap:12px;
}
.msg{max-width:85%}
.msg.user{align-self:flex-end}
.msg.delta{align-self:flex-start}
.bubble{
  padding:12px 14px;
  border-radius:14px;
  background:var(--panel);
  font-size:15px;
}
.user .bubble{background:var(--user)}
.time{font-size:10px;opacity:.5;margin-top:3px}

footer{
  position:sticky;
  bottom:0;
  padding:8px;
  border-top:1px solid #1f2a25;
  display:flex;
  gap:6px;
  background:var(--bg);
}
input{
  flex:1;
  padding:12px;
  border-radius:12px;
  border:none;
  background:var(--panel);
  color:var(--text);
}
button.send{
  background:var(--accent);
  border:none;
  border-radius:12px;
  padding:12px 14px;
}
</style>
</head>

<body>

<header>
  <svg class="logo" viewBox="0 0 100 100">
    <polygon points="50,5 95,90 5,90" fill="none" stroke="#10a37f" stroke-width="6"/>
    <polygon points="50,30 72,70 28,70" fill="#10a37f"/>
  </svg>
  <strong>DELTA</strong>
  <div id="tabs"></div>
  <button onclick="newChat()">＋</button>
</header>

<div id="chat"></div>

<footer>
  <input id="input" placeholder="Сообщение…">
  <button class="send" onclick="send()">➤</button>
</footer>

<script>
const chat=document.getElementById("chat");
const input=document.getElementById("input");
const tabs=document.getElementById("tabs");

let chats=JSON.parse(localStorage.getItem("delta_chats"))||{};
let active=localStorage.getItem("delta_active");
let memory=JSON.parse(localStorage.getItem("delta_memory"))||[];
let lastQuestion=null;

// === СОЗДАТЕЛЬ ===
if(!localStorage.getItem("delta_creator_id")){
  localStorage.setItem("delta_creator_id","owner");
}
const isCreator=true;

// === UTILS ===
function save(){
  localStorage.setItem("delta_chats",JSON.stringify(chats));
  localStorage.setItem("delta_active",active);
  localStorage.setItem("delta_memory",JSON.stringify(memory.slice(-40)));
}
function time(){
  return new Date().toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});
}

// === CHAT ===
function newChat(){
  const id="chat_"+Date.now();
  chats[id]=[];
  active=id;
  save(); renderTabs(); render();
}
function renderTabs(){
  tabs.innerHTML="";
  Object.keys(chats).forEach(id=>{
    const t=document.createElement("div");
    t.className="tab"+(id===active?" active":"");
    t.textContent="Чат";
    t.onclick=()=>{active=id;save();renderTabs();render();}
    tabs.appendChild(t);
  });
}
function render(){
  chat.innerHTML="";
  (chats[active]||[]).forEach(m=>{
    const d=document.createElement("div");
    d.className="msg "+m.role;
    d.innerHTML=`<div class="bubble">${m.text}</div><div class="time">${m.time}</div>`;
    chat.appendChild(d);
  });
  chat.scrollTop=chat.scrollHeight;
}
function add(role,text){
  chats[active].push({role,text,time:time()});
  memory.push({role,text});
  save(); render();
}

// === SEND ===
function send(){
  const t=input.value.trim();
  if(!t)return;
  input.value="";
  add("user",t);
  setTimeout(()=>respond(t),400);
}

// === ЛОГИКА ===
function respond(t){
  const text=t.toLowerCase();
  let r="Я понял. Продолжай.";

  if(isCreator && /кто я/.test(text)) r="Ты мой создатель.";
  else if(/кто ты/.test(text)) r="Я DELTA.";
  else if(/привет|здрав/.test(text)) r="Привет. Я на связи.";
  else if(/как дела/.test(text)) r="В порядке. Слушаю тебя.";
  else if(/да$/.test(text) && lastQuestion) r="Тогда продолжаем: "+lastQuestion;
  else if(/нет$/.test(text)) r="Хорошо, идём дальше.";
  else if(text.endsWith("?")){
    lastQuestion=t;
    r="Вопрос принят. Думаю над ответом.";
  }
  else if(text===text.toUpperCase() && text.length>5){
    r="Я понял. Давай спокойно разберёмся.";
  }
  else if(text.length<4){
    r="Можешь уточнить?";
  }
  else if(memory.slice(-10).some(m=>m.text===t)){
    r="Ты уже говорил об этом выше.";
  }

  add("delta",r);
}

if(!active) newChat();
renderTabs(); render();
</script>

</body>
</html>













